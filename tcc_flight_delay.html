<!DOCTYPE html>
<html lang="en-GB" dir="ltr">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Employee Master</title>

<!-- Ø«ÙŠÙ… Ù…Ø­ÙÙˆØ¸ -->
<script>
(function(){
  try{
    var t=(localStorage.getItem('theme')||localStorage.getItem('tcc_theme')||'').toLowerCase();
    if(t==='dark') document.documentElement.setAttribute('data-theme','dark');
    else document.documentElement.removeAttribute('data-theme');
    window.addEventListener('storage',e=>{
      if(e.key==='theme'||e.key==='tcc_theme'){
        var v=(e.newValue||'').toLowerCase();
        if(v==='dark') document.documentElement.setAttribute('data-theme','dark');
        else document.documentElement.removeAttribute('data-theme');
      }
    });
  }catch(e){}
})();
</script>

<style>
:root{
  --bg:#F6F4F1; --card:#FAFAFA; --text:#0F1220; --muted:#6B7280;
  --brand:#22D3A6; --accent:#6D28D9; --ring:#E8E8E8;
  --shadow:0 10px 30px rgba(2,8,23,.12); --radius:22px;
}
html[data-theme="dark"]{
  --bg:#000; --card:#141414; --text:#E6E7EB; --muted:#A0A6AE;
  --ring:#2A2A2A; --brand:#1A1A1A; --accent:#1A1A1A;
  --shadow:0 10px 30px rgba(0,0,0,.35);
}

*{box-sizing:border-box}
html,body{
  height:100%; margin:0; overflow:hidden;
  font:14px/1.5 "Segoe UI",Inter,Roboto,system-ui,-apple-system,sans-serif;
  color:var(--text);
}

/* â† â† ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙˆÙ‡Ø¬ Ø§Ù„Ø£Ø®Ø¶Ø± Ù„Ù„Ø®Ù„ÙÙŠØ© Ù‡Ù†Ø§ */
body{
  background:
    radial-gradient(1200px 800px at 85% -10%, color-mix(in oklab, var(--brand) 20%, transparent), transparent 60%),
    radial-gradient(1000px 700px at -10% 100%, color-mix(in oklab, var(--brand) 20%, transparent), transparent 55%),
    var(--bg);
  color:var(--text);
  font:14px/1.5 "Segoe UI",Inter,Roboto,system-ui,-apple-system,sans-serif;
}

.container{max-width:1120px;margin:32px auto;padding:0 16px}

/* Ø§Ù„Ù‡ÙŠØ¯Ø± */
.header{display:flex;gap:10px;align-items:center;justify-content:flex-end;margin-bottom:18px}
.btn{
  display:inline-flex;align-items:center;gap:6px;
  border:1px solid var(--ring);
  background:var(--card);color:var(--text);
  padding:9px 14px;border-radius:12px;cursor:pointer;text-decoration:none;
  transition:background .2s,transform .15s;
}
.btn:hover{background:var(--ring);transform:translateY(-2px)}
.btn[data-variant="primary"]{background:#22D3A6;color:#fff;border:0}
.btn-row{display:flex;gap:10px}

.panel{
  background:var(--card);border:1px solid var(--ring);border-radius:var(--radius);
  box-shadow:var(--shadow);display:flex;flex-direction:column;min-height:0;
}
.toolbar{display:flex;justify-content:space-between;align-items:center;padding:12px 18px;border-bottom:1px solid var(--ring)}
.form-wrapper{padding:18px;overflow-y:auto;max-height:80vh;}
.form-wrapper::-webkit-scrollbar { width: 4px; }
.form-wrapper::-webkit-scrollbar-thumb { background:#D5D5D5; border-radius:8px; }
.form-wrapper::-webkit-scrollbar-thumb:hover { background:#555555; }
html[data-theme="dark"] .form-wrapper::-webkit-scrollbar-track { background:transparent; }

.form{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.form .full{grid-column:1/-1}

.section{
  grid-column:1/-1; display:flex;align-items:center;gap:10px;
  margin:8px 0 4px; font-weight:700; color:var(--text);
}
.section .line{flex:1;height:1px;background:var(--ring);border-radius:1px}

label{display:block;color:var(--muted);font-size:12px;margin:7px 0 6px}
input,select,textarea{
  width:100%;padding:10px 12px;border-radius:12px;
  border:1px solid var(--ring);background:var(--card);color:var(--text);
}
textarea{min-height:90px;resize:vertical}
.mono{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;letter-spacing:.3px}

.toast{
  position:fixed;right:16px;bottom:16px;background:#111827;color:#fff;
  padding:12px 14px;border-radius:12px;box-shadow:var(--shadow);display:none
}
.toast.ok{background:linear-gradient(135deg,#16A34A,#22D3A6)}
.toast.err{background:linear-gradient(135deg,#EF4444,#F14668)}

#formTitle{display:none;}

#formDesc{display:none;}
</style>
<script src="/auth.js"></script>
</head>
<body>
<div class="container">
  <div class="header">
    <a href="../index.html" class="btn">âŸµ Back</a>
    <a href="../index.html" class="btn">ğŸ  Home</a>
  </div>

  <div class="panel">
    <div class="toolbar">
      <div>
        <div id="formTitle" style="font-weight:700;font-size:16px">Employee Master</div>
        <div id="formDesc" style="color:var(--muted);font-size:12px"></div>
      </div>
      <div class="btn-row">
        <button type="button" id="clearBtn" class="btn">Clear</button>
        <button type="button" id="submitBtn" class="btn" data-variant="primary">Submit</button>
      </div>
    </div>

    <div class="form-wrapper">
      <form id="dynForm" class="form"></form>
    </div>
  </div>
</div>

<div id="toast" class="toast">Saved</div>

<script>
const DATE_FMT='DD-MM-YYYY',TIME_FMT='HH:mm';
function normalizeDigits(s){if(!s)return s;const ar='Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©';return String(s).replace(/[Ù -Ù©]/g,ch=>String(ar.indexOf(ch)))}
function toDDMMYYYY(s){s=normalizeDigits(s);if(!s)return'';if(/^\d{2}-\d{2}-\d{4}$/.test(s))return s;if(/^\d{4}-\d{2}-\d{2}$/.test(s)){const y=s.slice(0,4),m=s.slice(5,7),d=s.slice(8,10);return `${d}-${m}-${y}`}return s}
function to24h(t){t=normalizeDigits(t);const m=String(t||'').match(/(\d{1,2}):(\d{2})/);if(!m)return'';let hh=parseInt(m[1],10);if(isNaN(hh))hh=0;hh=Math.max(0,Math.min(23,hh));const mm=m[2];return String(hh).padStart(2,'0')+':'+mm}
function showToast(msg,isErr=false){const t=document.getElementById('toast');t.textContent=msg;t.className='toast '+(isErr?'err':'ok');t.style.display='block';setTimeout(()=>t.style.display='none',2200)}
function attachMasks(root){
  root.querySelectorAll('input[data-mask="time"]').forEach(el=>{
    el.addEventListener('input',()=>{let v=normalizeDigits(el.value).replace(/[^0-9]/g,'').slice(0,4);if(v.length>=3)v=v.slice(0,2)+':'+v.slice(2);el.value=v});
    el.addEventListener('blur',()=>{if(/^(\d{1,2}):(\d{2})$/.test(el.value))el.value=to24h(el.value)});
  });
  root.querySelectorAll('input[data-mask="date"]').forEach(el=>{
    el.addEventListener('input',()=>{let v=normalizeDigits(el.value).replace(/[^0-9]/g,'').slice(0,8);if(v.length>=5)v=v.slice(0,2)+'-'+v.slice(2,4)+'-'+v.slice(4);else if(v.length>=3)v=v.slice(0,2)+'-'+v.slice(2);el.value=v});
  });
}

const FORM_DEF={
  id:"employee_master",
  title:"Employee Master",
  fields:[
    {type:"section",label:"General Information"},
    {name:"Date",label:"Date",type:"date",required:true},
    {name:"Shift",label:"Shift",type:"select",options:["Shift A","Shift B","Shift C"]},
    {name:"Department",label:"Department",type:"select",options:["TCC","FIC Saudia","FIC Nas","LC Saudia","LC Foreign"]},
    {name:"DutyManagerID",label:"Duty Manager ID",type:"text"},
    {name:"SupervisorID",label:"Supervisor ID",type:"text"},
    {name:"ControlID",label:"Control ID",type:"text"},
    {name:"EmployeeID",label:"Employee ID",type:"text"},

    /* â€” Ù‚Ø³Ù… Info Flight â€” */
    {type:"section",label:"Info Flight"},
    {name:"Airlines",label:"Airlines",type:"select",options:["Saudi Airlines","Flyadeal","Flynas","Riyadh Airlines","Foreign lines"]},
    {name:"FlightCategory",label:"Flight Category",type:"select",options:["International","Domestic","Foreign lines"]},
    {name:"FlightDirection",label:"Flight Direction",type:"select",options:["Arrival","Departure","Arrival & Departure"]},
    {name:"Gate",label:"Gate",type:"text"},

    {type:"section",label:"Arrivals"},
    {name:"ArrivalFlightNumber",label:"Arrival Flight Number",type:"text"},
    {name:"ArrivalDestination",label:"Arrival Destination",type:"text"},
    {name:"STA",label:"STA (HH:mm)",type:"time"},
    {name:"ATA",label:"ATA (HH:mm)",type:"time"},
    {name:"ArrivalViolations",label:"Arrival Violations",type:"textarea",class:"full"},

    {type:"section",label:"Departures"},
    {name:"DepartureFlightNumber",label:"Departure Flight Number",type:"text"},
    {name:"DepartureDestination",label:"Departure Destination",type:"text"},
    {name:"STD",label:"STD (HH:mm)",type:"time"},
    {name:"ATD",label:"ATD (HH:mm)",type:"time"},
    {name:"DepartureViolations",label:"Departure Violations",type:"textarea",class:"full"},

    {type:"section",label:"Incident Details"},
    {name:"DescriptionOfIncident",label:"Description of Incident",type:"textarea",class:"full"},
    {name:"FailureImpact",label:"Failure Impact",type:"textarea",class:"full"}
  ]
};

function boot(formDef){
  const dyn=document.getElementById('dynForm'); dyn.innerHTML='';
  formDef.fields.forEach(f=>{
    if(f.type==='section'){
      const s=document.createElement('div');
      s.className='section';
      s.innerHTML=`<span>${f.label}</span><div class="line"></div>`;
      dyn.appendChild(s);
      return;
    }
    const wrap=document.createElement('div');
    if(f.class==='full'||f.type==='textarea') wrap.className='full';
    const id=formDef.id+'_'+f.name;
    let ctrl='';
    if(f.type==='textarea'){ ctrl=`<textarea id="${id}"></textarea>`; }
    else if(f.type==='time'){ ctrl=`<input id="${id}" type="text" class="mono" data-mask="time" maxlength="5" placeholder="HH:mm"/>`; }
    else if(f.type==='date'){ ctrl=`<input id="${id}" type="text" class="mono" data-mask="date" maxlength="10" placeholder="DD-MM-YYYY"/>`; }
    else if(f.type==='select'){ ctrl=`<select id="${id}">${(f.options||[]).map(v=>`<option>${v}</option>`).join('')}</select>`; }
    else{ ctrl=`<input id="${id}" type="text"/>`; }
    wrap.innerHTML=`<label for="${id}">${f.label}</label>${ctrl}`;
    dyn.appendChild(wrap);
  });
  attachMasks(dyn);
  document.getElementById('clearBtn').onclick=()=>dyn.reset?.();
  document.getElementById('submitBtn').onclick=()=>showToast('Saved âœ“');
}
boot(FORM_DEF);
</script>
</body>
</html>
